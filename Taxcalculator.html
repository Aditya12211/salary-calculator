<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Salary Calculator Form</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

  <!-- Font Awesome CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <style>
    body{

      height:100dvh;
      display:grid;
      place-items: center;
    }
    .container{
      width:30%;
      padding:20px;
      box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;

    }
    .input-group-text {
      border: none;
    }
    .input-group-append {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
    }
    .form-control {
      position: relative;
    }
  </style>
</head>
<body>

<div class="container">
  <h2>Salary Calculator Form</h2>
  <form id="salaryForm">
    <div class="col-md-12 mb-3">
      <div class="form-group">
          <label for="ageGroup">Enter gross annual income</label><i type="button" class="fas fa-question-circle text-dark mx-2" data-bs-toggle="tooltip" data-bs-placement="top" title="Gorss annual income is your total salary in a year before any deductions"></i>
        <div class="input-group">
          <input type="text" class="form-control" id="totalSalary" placeholder="Enter total salary">
          <span class="input-group-text">
            <i class="fas fa-exclamation-circle text-dark" style="display: none;" data-toggle="tooltip" data-bs-placement="top" title=""></i>
          </span>
        </div>
      </div>
    </div>
    <div class="col-md-12 mb-3">
      <div class="form-group">
          <label for="ageGroup">Enter extra income</label><i type="button" class="fas fa-question-circle text-dark mx-2" data-bs-toggle="tooltip" data-bs-placement="top" title="Extra income from other sources"></i>
        <div class="input-group">
          <input type="text" class="form-control" id="extraIncome" placeholder="Enter extra income from other sources">
          <span class="input-group-text">
            <i class="fas fa-exclamation-circle text-dark" style="display: none;" data-bs-toggle="tooltip" data-bs-placement="top" title=""></i>
          </span>
        </div>
      </div>
    </div>
    <div class="col-md-12 mb-3">
      <div class="form-group">
          <label for="ageGroup">Enter total applicable deductions</label><i type="button" class="fas fa-question-circle text-dark mx-2" data-bs-toggle="tooltip" data-bs-placement="top" title="Total applicable deduction"></i>
        <div class="input-group">
          <input type="text" class="form-control" id="totalDeduction" placeholder="Add total applicable deduction">
          <span class="input-group-text">
            <i class="fas fa-exclamation-circle text-grey" style="display: none;" data-bs-toggle="tooltip" data-bs-placement="top" title=""></i>
          </span>
        </div>
      </div>
    </div>
    <div class="col-md-12 mb-3">
    <div class="form-group">
      <label for="ageGroup">Enter age group</label><i type="button" class="fas fa-question-circle text-dark mx-2" data-bs-toggle="tooltip" data-bs-placement="top" title="Age group"></i>
      <div class="input-group">
        <select class="form-control" id="ageGroup">
          <option value="">Select Age Group</option>
          <option value="1"><40</option>
          <option value="2">>=40 & <60</option>
          <option value="3">>=60</option>
        
        </select>
        <span class="input-group-text">
          <i class="fas fa-exclamation-circle text-dark" id="ageErrorIcon" style="display: none;" data-bs-toggle="tooltip" data-bs-placement="top" title=""></i>
        </span>
      </div>
    </div>
  </div>
    <button type="submit" class="btn col-md-12" style="background-color: #6610f2;">Submit</button>
  </form>
</div>

<!-- Bootstrap Modal -->
<div class="modal fade" id="successModal" tabindex="-1" role="dialog" aria-labelledby="successModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="successModalLabel">Success</h5>
        
      </div>
      <div class="modal-body">
       
      </div>
      <div class="modal-footer">
        <button type="button" class="btn" style="background-color: #6610f2;" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap JS and Font Awesome JS -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"></script>
<script>
  $(document).ready(function() {
   var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
  return new bootstrap.Tooltip(tooltipTriggerEl)
})


    // Function to show warning icon with tooltip
    function showWarning(inputField, message) {
      $(inputField).closest('.form-group').find('.fa-exclamation-circle').show().tooltip('dispose').tooltip({title: message})
    }

    // Function to hide warning icon and its tooltip
    function hideWarning(inputField) {
      $(inputField).closest('.form-group').find('.fa-exclamation-circle').hide().tooltip('dispose').tooltip({title: ""});
    }

    // Function to check if input is empty
    function isEmpty(inputValue) {
      return inputValue.trim() === '';
    }

    // Check if inputs are empty or contain non-numeric characters
    $('#salaryForm').submit(function(e) {
      e.preventDefault();

      var totalSalary = $('#totalSalary').val().trim();
      var extraIncome = $('#extraIncome').val().trim();
      var totalDeduction = $('#totalDeduction').val().trim();
      var ageGroup = $('#ageGroup').val();

      // Check if inputs are empty or contain non-numeric characters
      var invalidInputs = false;
      if (isEmpty(totalSalary) || isNaN(totalSalary) || isEmpty(extraIncome) || isNaN(extraIncome) || isEmpty(totalDeduction) || isNaN(totalDeduction)) {
        $('.form-group').each(function() {
          var inputField = $(this).find('input');
          var inputValue = inputField.val().trim();
          if (isEmpty(inputValue)) {
            showWarning(inputField, "This field is mandatory");
          } else if (isNaN(inputValue)) {
            showWarning(inputField, "Please enter numbers only");
          } else {
            hideWarning(inputField);
          }
        });
        invalidInputs = true;
      } else {
        // Hide all warning icons if all inputs are valid
        $('.fa-exclamation-circle').hide();

        // Check if age group is selected
        if (isEmpty(ageGroup)) {
             $('#ageErrorIcon').show().tooltip('dispose').tooltip({title: "Age group is mandatory"});
          invalidInputs = true;
        } else {
          $('#ageErrorIcon').hide();
        }
      }

      // Show success modal if there are no errors
      if (!invalidInputs) {
       var totalsal= parseInt(totalSalary) + parseInt(extraIncome) - parseInt(totalDeduction);
       console.log(totalsal)
       var finalsal;
     if(totalsal > 800000){
       if(ageGroup ==1){
      finalsal= .3*(totalsal - 800000);
      console.log(finalsal);
       }else if(ageGroup ==2){
        finalsal= .4*(totalsal - 800000);
       }else{
        finalsal= .1*(totalsal - 800000);
       }

     }else{
      var finalsal=totalsal
     }
        $('#successModal .modal-body').text('Your overall income will be ' + finalsal.toFixed(2) + ' after tax deductions');


        $('#successModal').modal('show');
      }
    });
  });
</script>
</body>
</html>
